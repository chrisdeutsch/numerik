\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[german]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}

\usepackage{graphicx}
\usepackage{caption}

\author{Christian Bespin \and Christopher Deutsch}
\title{Übungsblatt 1: Numerische Methoden der Physik}
\begin{document}
\maketitle

\section{Madelung-Konstante des NaCl-Kristalls}
\subsection{Physikalischer Hintergrund}
In einem Kristallgitter sind die Ionen durch elektrostatische Wechselwirkung
untereinander an den Kristall gebunden. Uns interessiert die durchschnittliche
potentielle Energie eines dieser Ionen (wird mit dem Index $i$ bezeichnet).
Diese entsteht in erster Näherung aus der Überlagerung der Coulomb-Potentiale
der Punktladungen im Kristallgefüge
(werden mit dem Index $j$ bezeichnet). Die Ladungszahl des jeweiligen Ions sei $z$
und $r_{ij}$ ist der Abstand des betrachteten Ionenpaars. Wir summieren für
jedes Ion des Kristalls (mit Ausnahme des $i$-Ions, da dessen Potential auf sich
selbst keinen Einfluss hat) den Beitrag zum Potential:

\begin{align}
\label{EPot}
E_G = \sum_{j\atop i \neq j} \frac{1}{4 \pi \epsilon_0}
\frac{z_i e \cdot z_j e}{r_{ij}}
\end{align}
Erweitern der Gleichung (\ref{EPot}) mit dem Gitterabstand $a$ und
Zusammenfassen des Faktors in die durchschnittliche Energie eines Ionenpaars
$E_P$ mit Abstand $a$ ergibt:

\begin{align}
E_G = \frac{1}{4 \pi \epsilon_0} \frac{e^2}{a} \sum_{j\atop i \neq j}
\frac{z_i z_j}{r_{ij}/a} = E_P \sum_{j\atop i \neq j} \frac{z_i z_j}{r_{ij}/a}
\end{align}
Schließlich wird die Geometrie des Kristalls in der Madelung-Konstante
zusammengefasst:

\begin{align}
\label{Madelungkonstante}
\alpha = \frac{E_G}{E_P} = \sum_{j\atop i \neq j} \frac{z_i z_j}{r_{ij}/a}
\end{align}
Dabei ist $r_{ij}/a$ der mit der Gitterkonstanten normalisierte Abstand der Ionen,
welcher im Folgenden ausschließlich für Längen verwendet wird.

\subsection{Algorithmus im 3-dimensionalen Fall}
\subsubsection{Struktur von Natriumchlorid}

Die nächsten Nachbarn eines jeden Ions sind sechs Ionen entgegengesetzter
Ladung. Diese Ionen befinden sich an den Eckpunkten eines regelmäßigen
Oktaeders. Dadurch kann das Vorzeichen der Ladung an der Gitterstelle
$\mathbf{r} = \left( x,y,z \right)$ relativ zu einer anderen Ladung durch:
\begin{align}
\mathrm{sgn}\left(z(\mathbf{r})\right) = \pm \left( -1 \right)^{x+y+z}
\label{eq:vorzeichen}
\end{align}
berechnet werden. Dabei wird das Vorzeichen so gewählt, dass dieses mit der Ladung
des Referenz-Ions übereinstimmt (Na: $+$; Cl: $-$). Diese Tatsache
äußert sich auch darin, dass das Vorzeichen der Madelung-Konstante vom
betrachteten Ion abhängt (generell: $\alpha_{Na} = - \alpha_{Cl}$).
\subsubsection{Probleme der naiven Methode}

Zunächst wurde die naive Implementierung analog zur mathematischen Beschreibung
getestet. Dabei wurde die Madelung-Konstante für einen Würfel analog zu
Gl. (\ref{Madelungkonstante}), über sukzessive Erweiterung des Würfels um eine
Schale berechnet. Es fällt schnell die schlechte Konvergenz auf, die sich
physikalisch darin manifestiert, dass der Kristall, beim einfachen Erweitern
mit einer Hülle, nicht elektrisch neutral bleibt. Dieses Problem wurde von Evjen
\cite{Evjen} gelöst, indem er den Kristall in elektrisch neutrale Elementarzellen
aufteilt, die einen flacheren Potentialverlauf haben als einzelne Punktladungen.
Dazu werden die Ladung gemäß der Abbildung \ref{skalierungsgrafik3d} gewichtet,
dabei sind die gebrochenen Ladungen durch das Überlappen der Elementarzellen motiviert
(vgl. Abb. \ref{zellensumme} für das zweidimensionale Analogon). Die Summe über 
alle Elementarzellen eines Würfels resultiert darin, dass die Ecken des Würfels
$\frac{1}{8}$, Kanten $\frac{1}{4}$ und Seitenflächen $\frac{1}{2}$ gewichtet werden.

\subsubsection{Beschreibung}

Der verwendete Algorithmus beginnt mit einem Ion im Koordinatenursprung. Dieses
erweitern wir schrittweise um eine Schale von Ionen mit den Ladungenzahlen gemäß
Gl. (\ref{eq:vorzeichen}). Wir nutzen nun die Symmetrie des Würfels, um den Beitrag
der so konstruierten Schale zur Madelung-Konstante zu berechnen. Dazu teilen wir die
Schale in 8 äquivalente Ecken, 12 Kanten und 6 Seitenflächen auf, berechnen für
jeweils eines dieser Objekte den Beitrag zur Madelung-Konstante (nach Evjen gewichtet)
und multiplizieren mit dem entsprechenden Faktor. Dabei ist zu beachten, dass wir
den Rest der Gewichtung zwischenspeichern müssen, da nach dem Hinzufügen der nächsten
Schale die Ionen im Inneren des Würfels voll gewichtet werden (bei der nächsten Schale
wird dann einfach der Rest auf die Madelung-Konstante addiert). Diese Vorgehensweise ist notwendig, da wir das Verfahren solange wiederholen, bis die Differenz der Madelungkonstante
von zwei aufeinanderfolgenden Schalen kleiner als eine Zahl $0 < \epsilon < 1$ wird. Die
mathematische Relevanz dieser Abbruchbedingung wird in Abschnitt \ref{sssec:Konvergenz}
erklärt.

Wir gehen in jedem Schleifendurchlauf davon aus, dass aktuell die äußerste Schale berechnet
wird und summieren so zunächst nur über die gewichteten Ladungen (Variable \texttt{sum}).
Den zu voller Gewichtung fehlenden Anteil summieren wir in jedem Schleifendurchlauf in der Variable
\texttt{rest} auf. Falls die Abbruchbedingung noch nicht erfüllt ist, wird diese zur
Gesamtsumme addiert, denn dann wurde im vorherigen Schleifendurchlauf noch nicht die
äußerste Schale betrachtet und alle Ladungen müssen voll gewichtet werden. Diese Methode
wurde gewählt, um mithilfe von \texttt{rest} den mit jeder Vergrößerung des Würfels
hinzukommenden Beitrag auswerten zu können und ein sinnvolles Abbruchkriterium zu definieren.\\

\begin{figure}[h]
	\centering
	\includegraphics[scale = 0.35]{./figures/wuerfel.eps}
	\caption{neutrale Elementarzelle nach Evjen}
	\label{skalierungsgrafik3d}
\end{figure}

\subsubsection{Konvergenz}
\label{sssec:Konvergenz}

\begin{itemize}
\item erkläre physikalischen Hintergrund für die bessere Konvergenz der Evjen
Methode
\item das Potential einer neutralen Elementarzelle fällt schneller ab als das
einer geladenen
\end{itemize}

\begin{table}[h]
\centering
\begin{tabular}{c|c|c}
\rule[-1ex]{0pt}{2.5ex} $n$ & $\alpha$ & $\delta$ \\ 
\hline 
\rule[-1ex]{0pt}{2.5ex} $4$ & $1.747721109631$ & $8.96\cdot10^{-5}$ \\ 
\hline 
\rule[-1ex]{0pt}{2.5ex} $8$ & $1.747574381726$ & $5.60\cdot10^{-6}$ \\ 
\hline 
\rule[-1ex]{0pt}{2.5ex} $20$ & $1.747564845218$ & $1.42\cdot10^{-7}$ \\ 
\hline 
\rule[-1ex]{0pt}{2.5ex} $50$ & $1.747564601048$ & $3.67\cdot10^{-9}$ \\ 
\hline 
\rule[-1ex]{0pt}{2.5ex} $100$ & $1.747564595034$ & $2.30\cdot10^{-10}$ \\ 
\end{tabular} 
\caption{Konvergenz}
\end{table}

\subsection{Algorithmus im 2-dimensionalen Fall}
\subsubsection{Beschreibung}
Die Methode von Evjen zur Gewichtung der Ladung ist leicht vom 3-Dimensionalen
in das 2-Dimensionale zu übertragen, denn es ist leicht zu sehen, dass um elektrische
Neutralität einer Elementarzelle zu erreichen, die Ecken mit $\frac{1}{4}$ und die Kanten mit
$\frac{1}{2}$ gewichtet werden müssen (Abbildung \ref{skalierungsgrafik2d}).
\\
\\
\begin{minipage}[c]{0.5\textwidth}
\begin{center}
\includegraphics[height=0.65\textwidth]{./figures/quadrat.eps}
\captionof{figure}{neutrale Elementarzelle (2-dim.)}
\label{skalierungsgrafik2d}
\end{center}
\end{minipage}
\begin{minipage}[c]{0.5\textwidth}
\begin{center}
\includegraphics[height=0.65\textwidth]{./figures/elementarzelle.eps}
\captionof{figure}{Elementarzelle im Gefüge}
\label{zellensumme}
\end{center}
\end{minipage}
	

\subsubsection{Konvergenz}

Wie gut konvergiert der 2-dimensionale Algorithmus.

\subsection{Fazit}

Verwendeter Literaturwert $\alpha_{NaCl} = 1.7475646946331822$ \cite{Sakamoto} .


\begin{thebibliography}{9}

\bibitem{Evjen}
Evjen, H. M.
\emph{On the Stability of Certain Heteropolar Crystals},
Physical Review Letters \textbf{39},
675-687 (1932)

\bibitem{Sakamoto}
Sakamoto, Y.
\emph{Madelung Constants of Simple Crystals Expressed in Terms of Born's Basic
Potentials of 15 Figures},
The Journal of Chemical Physics \textbf{28},
164 (1958)

\end{thebibliography}

\end{document}
