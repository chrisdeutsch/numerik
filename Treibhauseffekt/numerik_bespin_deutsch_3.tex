\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[german]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mhchem}
\usepackage{siunitx}
\usepackage{multirow}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{wrapfig}
\usepackage{graphicx}
\usepackage[outdir=./]{epstopdf}
\usepackage{caption}
\usepackage[colorlinks]{hyperref}


\author{Christian Bespin \and Christopher Deutsch}
\title{Übungsblatt 3: Numerische Methoden der Physik}
\begin{document}
\maketitle

\setcounter{section}{1}

\section{Treibhauseffekt}

\subsection{Physikalischer Hintergrund}
Der Treibhauseffekt beschreibt den Einfluss der Atmosphäre und der in ihr
auftretenden Gase auf die Temperatur der Erde. Während die Sonnenstrahlung die
Atmosphäre zu großen Teilen durchdringt, wird die von der Erde emittierte
infrarote Strahlung von den Gasen der Atmosphäre absorbiert (vorallem durch Wasserdampf
aber auch durch Spurengase wie \ce{CO2}), was zu einer Erwärmung des Klimas führt.

Zur Erklärung des Treibhauseffektes wird ein Modell grauer und schwarzer Körper
im thermischen Gleichgewicht verwendet. Wir beschreiben die Erde als schwarzen
Strahler mit Emissions-/Absorptionsgrad $\epsilon_E = \alpha_E = 1$. Die Sonne 
wird durch einen grauen Strahler der Temperatur $T_S$ mit Emissionsgrad
$\epsilon_S = \text{konst.}$ ersetzt.
Auch die Atmosphäre wird als grauer Strahler modelliert. Diese habe die
Temperatur $\tau$ und den Emissionsgrad $\epsilon(\tau)$. 
Das Kirchhoff'sche Strahlungsgesetz besagt, dass der Emissionsgrad $\epsilon$ eines
grauen Körpers gleich seinem Absorptionsgrad $\alpha$ ist. Demnach hat die
Atmosphäre für Strahlung der Temperatur $T$ den Absorptionsgrad $\alpha(\tau) = \epsilon(\tau)$.

\begin{wrapfigure}[14]{R}[1pt]{0.47\textwidth}
\centering
\includegraphics[width=0.45\textwidth]{./figures/strahlungsgleichgewicht.eps}
\caption{Strahlungsgleichgewicht}
\label{fig:strahlungsgleichgewicht}
\end{wrapfigure}
Ein Körper ist im thermischen Gleichgewicht, wenn seine abgestrahlte Leistung
gleich seiner absorbierten Leistung ist. Diese wird durch das Stefan-Boltzmann-Gesetz
$P \propto \epsilon T^4$ beschrieben. Die Gleichgewichtsbedingung für die Atmosphäre ist:
\begin{align}
	2\epsilon(\tau)\tau^4 &= \alpha(T_S) \epsilon_S T_S^4 + \alpha(T_E) \epsilon_E T_E^4 \notag \\ &=\epsilon(T_S) \epsilon_S T_S^4 + \epsilon(T_E) T_E^4
\end{align}
Dabei wurde die Proportionalitätskonstante aus der Gleichung heraus gekürzt.
Der Term auf der linken Seite beschreibt die Abstrahlung der Atmosphäre, wobei
Faktor $2$ die Abstrahlung sowohl zur Erde als auch zur Sonne beschreibt.
Die rechte Seite beschreibt die Absorption, dabei wurde erst im letzten
Umformungsschritt $\epsilon_E = 1$ und das Kirchhoff'sche Strahlungsgesetz verwendet,
um den Unterschied zwischen der Absorption der Atmosphäre und des Emissionsgrades von
Sonne/Erde deutlich zu machen.
Analog dazu erhält man zwei weitere Gleichgewichtsbedingungen, aus denen man
$\tau$ eliminieren kann und eine Bestimmungsgleichung für die Temperatur $T_E$
der Erde im Gleichgewicht erhält:
\begin{align}
\left[2-\epsilon(T_E)\right]T_E^4=\epsilon_S\left[2-\epsilon(T_S)\right]T_S^4
\label{eqn:gleichgewicht}
\end{align}

HIER NOCH WAS ZUR EMISSIVITÄT. Abhängigkeit von Wirkungsquerschnitt (Breit-Wigner) 

\subsection{Implementierung}
Im wesentlichen besteht unser Programm aus zwei Teilen:
\begin{enumerate}
	\item die benötigten numerischen Methoden zum Lösen der nichtlinearen Gleichung (Referenz) also Integration und numerisches Lösen von Gleichungen
	\item die konkrete Implementierung des physikalischen Problems
\end{enumerate}
Wir haben uns bemüht diese Teile im Quellcode strikt zu trennen um Übersichtlichkeit zu gewährleisten.
Die numerischen Methoden finden sich in dem Modul \texttt{numerik\_bespin\_deutsch\_mathfunctions} und die Lösung des physikalischen Problems in der Hauptquelldatei \texttt{numerik\_bespin\_deutsch\_3.c}

Z wurde analytisch berechnet: $Z=\frac{8}{15}\frac{\pi^5 \mathrm{kT}}{\mathrm{c}^3}$

\subsubsection{Nullstellenberechnung mit Bisektion}

Ein Verfahren, um numerisch Nullstellen zu bestimmen, ist das Iterationsverfahren der Bisektion. Dabei wird vorausgesetzt, dass die Funktion auf dem relevanten Intervall $[a,b]$ stetig ist und dort einen Vorzeichenwechsel hat. Dann folgt aus dem Zwischenwertsatz, dass dort garantiert eine Nullstelle liegt. Die Bisektion halbiert zunächst das zu betrachtende Intervall und prüft, ob zwischen den Grenzen der Teilintervalle ein Vorzeichenwechsel in den Funktionswerten vorliegt. Da die Funktion nach Voraussetzung nur einen Vorzeichenwechsel auf dem ganzen Intervall hatte, tritt in einem der Teilintervalle kein Vorzeichenwechsel auf und dieses wird im Folgenden vernachlässigt. Bei dem nächsten Schleifendurchlauf wird dieses Verfahren auf das verbleibende Teilintervall angewendet. Das Intervall, auf dem der Vorzeichenwechsel stattfindet, wird so immer weiter eingeschränkt, bis es eine gewünschte vorgegebene Genauigkeit erreicht (Intervallbreite $<\epsilon$). 
Wir verwenden die Bisektion hier, da im Gegensatz zum Newtonverfahren keine Ableitungen der Funktion  berechnet werden müssen. Bei der hier vorliegenden Funktion ist die Ableitung nur numerisch bestimmbar, was den Rechenaufwand erheblich negativ beeinträchtigen würde.

\subsubsection{Numerische Integration mit rekursivem Simpson-Verfahren}

Die Simpson-Methode nähert das Integral einer Funktion $f$ auf dem Intervall $[x_0,x_2]$ durch das Integral des Interpolationspolynoms mit den Stützstellen $x_0$, $x_1$ und $x_2$, wobei $x_1$ gerade das Intervall halbiert. Die Auswertung der Näherung ist:
\begin{align}
  \int_{x_0}^{x_2} f(x) \, \mathrm{d}x \approx \frac{h}{6} \left( f(x_0) + 4 f(x_1) + f(x_2) \right) \quad \text{mit } h = x_2 - x_0
\end{align}
Man kann die Näherung des Integrals verbessern, indem man das Intervall halbiert und schließlich auf den Teilintervallen erneut die Simpson-Methode anwendet. Dies kann je nach Präzisionsbedarf beliebig oft wiederholt werden.

Wir haben uns für die Implementierung der adaptiven Simpson-Methode entschieden, bei der das Integral rekursiv berechnet wird. Dazu wird das zu integrierende Intervall halbiert und anschließend werden diese Teilintervalle mit der Simpson-Methode ausgewertet (+Integral des Gesamtintervalls). Sollte die Differenz der Summe der integrierten Teilintervalle und des Gesamtintervalls eine Grenze $\epsilon$ überschreiten, wird das Verfahren auf jedem der Teilintervalle wiederholt. Da bei der Rekursion die Intervalle halbiert werden, muss auch mit jedem Schritt die Grenze $\epsilon$ halbiert werden, um eine sinnvolle Fehlereinschätzung zu gewährleisten. In \cite{lyness} wird gezeigt, dass $\epsilon / 15$ ein guter Schätzer für den absoluten Fehler der Näherung ist.

Der Vorteil einer rekursiven Umsetzung ist, dass sich der adaptive Mechanismus leicht implementieren lässt, da sich jedes Teilintervall unabhängig betrachten lässt. Dabei ist die Idee, dass man eine sehr feine Intervallteilung in Bereichen starker und eine sehr Grobe in Bereichen minimaler Änderung des Integranden vornimmt.


\subsubsection{Abbruchbedingungen}

Integrationsgrenzen

\subsubsection{Genaugkeit}

\subsection{Physikalische Ergebnisse}
\label{ssec:physikalischeergebnisse}

$T_E(\tilde{n})$ ist in Abbildung \ref{fig:ergebnisse} grafisch dargestellt. Dort ist ebenfalls der aktuelle Wert ($\tilde{n}=1$) eingezeichent. Man sieht gut, dass mit steigendem $\tilde{n}$ und damit mehr \ce{CO2} Molekülen in einer Luftsäule von 1\si{\meter^2} die Temperatur der Erde ein Sättigungsverhalten aufweist, die Temperatur steigt immer langsamer. (Für höhere $\tilde{n}$, die in Abbildung \ref{fig:ergebnisse} nicht mehr dargestellt sind, erreicht die Temperatur ein Maximum und nimmt dann linear ab.) Das Modell ist nur bedingt gut geeignet, es stellt schon für den Wert von $\tilde{n}=1$ (was dem aktuellen Wert entsprechen würde) eine zu hohe Temperatur dar. 2013 war die globale Durchschnittstemperatur 14,52 \si{\celsius} \cite{noaa}. Weiterhin berücksichtigt das verwendete Modell nur das Treibhausgas \ce{CO2}, obwohl sich die Atmosphäre aus vielen verschiedenen Gasen mit unterschiedlich starken Auswirkungen auf den Treibhauseffekt zusammensetzt (z.B. Wasserdampf, FCKW). Trotzdem wird qualitativ gut dargestellt, dass sich die Temperatur der Erde mit steigender Anzahl \ce{CO2} Moleküle in der Atmosphäre erhöht.

\begin{thebibliography}{9}

\bibitem{lyness}
 Lyness, J. N.,
 \emph{Notes on the Adaptive Simpson Quadrature Routine},
Journal of the ACM
Volume 16 Issue 3, (1969) 
Seiten 483-495 

\bibitem{noaa}
Global Analysis - Annual 2013, National Climatic Data Center (National Oceanic And Atmospheric Administration) Internet: http://www.ncdc.noaa.gov/sotc/global/2013/13 (2013), abgerufen am 23.05.2014

\end{thebibliography}

\begin{appendix}
\section{Grafiken}

\begin{figure}[htbp]
\centering
\input{./figures/rho}
\caption{Integrand für $T=300\, \si{\kelvin}$}

\input{./figures/rho_sonne}
\caption{Integrand für $T=5750\, \si{\kelvin}$}
\label{fig:integranden}
\end{figure}

\begin{figure}
\centering
\input{./figures/temperatur}
\caption{$T_E$ in Abhängigkeit von $\tilde{n}$}
\label{fig:ergebnisse}
\end{figure}
\end{appendix}

\end{document}
