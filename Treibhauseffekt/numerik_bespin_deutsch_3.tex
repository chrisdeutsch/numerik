\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[german]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mhchem}
\usepackage{siunitx}
\usepackage{multirow}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{wrapfig}
\usepackage{graphicx}
\usepackage[outdir=./]{epstopdf}
\usepackage{caption}
\usepackage[colorlinks]{hyperref}


\author{Christian Bespin \and Christopher Deutsch}
\title{Übungsblatt 3: Numerische Methoden der Physik}
\begin{document}
\maketitle

\setcounter{section}{1}

\section{Treibhauseffekt}

\subsection{Physikalischer Hintergrund}
Der Treibhauseffekt beschreibt den Einfluss der Atmosphäre und der in ihr
auftretenden Gase auf die Temperatur der Erde. Während die Sonnenstrahlung die
Atmosphäre zu großen Teilen durchdringt, wird die von der Erde emittierte
infrarote Strahlung von den Gasen der Atmosphäre absorbiert (vorallem durch Wasserdampf
aber auch durch Spurengase wie \ce{CO2}), was zu einer Erwärmung des Klimas führt.

Zur Erklärung des Treibhauseffektes wird ein Modell grauer und schwarzer Körper
im thermischen Gleichgewicht verwendet. Wir beschreiben die Erde als schwarzen
Strahler mit Emissions-/Absorptionsgrad $\epsilon_E = \alpha_E = 1$. Die Sonne 
wird durch einen grauen Strahler der Temperatur $T_S$ mit Emissionsgrad
$\epsilon_S = \text{konst.}$ ersetzt.
Auch die Atmosphäre wird als grauer Strahler modelliert. Diese habe die
Temperatur $\tau$ und den Emissionsgrad $\epsilon(\tau)$. 
Das Kirchhoff'sche Strahlungsgesetz besagt, dass der Emissionsgrad $\epsilon$ eines
grauen Körpers gleich seinem Absorptionsgrad $\alpha$ ist. Demnach hat die
Atmosphäre für Strahlung der Temperatur $T$ den Absorptionsgrad $\alpha(\tau) = \epsilon(\tau)$.

\begin{wrapfigure}[14]{R}[1pt]{0.47\textwidth}
\centering
\includegraphics[width=0.45\textwidth]{./figures/strahlungsgleichgewicht.eps}
\caption{Strahlungsgleichgewicht}
\label{fig:strahlungsgleichgewicht}
\end{wrapfigure}
Ein Körper ist im thermischen Gleichgewicht, wenn seine abgestrahlte Leistung
gleich seiner absorbierten Leistung ist. Diese wird durch das Stefan-Boltzmann-Gesetz
$P \propto \epsilon T^4$ beschrieben. Die Gleichgewichtsbedingung für die Atmosphäre ist:
\begin{align}
	2\epsilon(\tau)\tau^4 &= \alpha(T_S) \epsilon_S T_S^4 + \alpha(T_E) \epsilon_E T_E^4 \notag \\ &=\epsilon(T_S) \epsilon_S T_S^4 + \epsilon(T_E) T_E^4
\end{align}
Dabei wurde die Proportionalitätskonstante aus der Gleichung heraus gekürzt.
Der Term auf der linken Seite beschreibt die Abstrahlung der Atmosphäre, wobei
Faktor $2$ die Abstrahlung sowohl zur Erde als auch zur Sonne beschreibt.
Die rechte Seite beschreibt die Absorption, dabei wurde erst im letzten
Umformungsschritt $\epsilon_E = 1$ und das Kirchhoff'sche Strahlungsgesetz verwendet,
um den Unterschied zwischen der Absorption der Atmosphäre und des Emissionsgrades von
Sonne/Erde deutlich zu machen.
Analog dazu erhält man zwei weitere Gleichgewichtsbedingungen, aus denen man
$\tau$ eliminieren kann und eine Bestimmungsgleichung für die Temperatur $T_E$
der Erde im Gleichgewicht erhält:
\begin{align}
\left[2-\epsilon(T_E)\right]T_E^4=\epsilon_S\left[2-\epsilon(T_S)\right]T_S^4
\end{align}

HIER NOCH WAS ZUR EMISSIVITÄT. Abhängigkeit von Wirkungsquerschnitt (Breit-Wigner) 

\subsection{Implementierung}
Im wesentlichen besteht unser Programm aus zwei Teilen:
\begin{enumerate}
	\item die benötigten numerischen Methoden zum Lösen der nichtlinearen Gleichung (Referenz) also Integration und numerisches Lösen von Gleichungen
	\item die konkrete Implementierung des physikalischen Problems
\end{enumerate}
Wir haben uns bemüht diese Teile im Quellcode strikt zu trennen um Übersichtlichkeit zu gewährleisten.
Die numerischen Methoden finden sich in dem Modul \texttt{numerik\_bespin\_deutsch\_mathfunctions} und die Lösung des physikalischen Problems in der Hauptquelldatei \texttt{numerik\_bespin\_deutsch\_3.c}

Z wurde analytisch berechnet: $Z=\frac{8}{15}\frac{\pi^5 \mathrm{kT}}{\mathrm{c}^3}$

\subsubsection{Nullstellenberechnung mit Bisektion}

Ein Verfahren, um numerisch Nullstellen zu bestimmen, ist das Iterationsverfahren der Bisektion. Wir verwenden dieses hier, da es im Gegensatz zum Newtonverfahren keine Ableitungen der Funktion berechnen und auswerten muss. Dabei wird vorausgesetzt, dass die Funktion auf dem relevanten Intervall $[a,b]$ stetig ist und dort einen Vorzeichenwechsel hat. Dann folgt aus dem Zwischenwertsatz, dass dort garantiert eine Nullstelle liegt. Die Bisektion halbiert zunächst das zu betrachtende Intervall und prüft, ob zwischen den Grenzen der Teilintervalle ein Vorzeichenwechsel in den Funktionswerten vorliegt. Da die Funktion nach Voraussetzung nur eine Nullstelle auf dem ganzen Intervall hatte, tritt in einem der Teilintervalle kein Vorzeichenwechsel auf und dieses wird im Folgenden vernachlässigt. Bei dem nächsten Schleifendurchlauf wird dieses Verfahren auf das verbleibende Teilintervall angewendet. Das Intervall, auf dem der Vorzeichenwechsel stattfindet, wird so immer weiter eingeschränkt, bis es eine gewünschte vorgegebene Genauigkeit erreicht (Intervallbreite $<\epsilon$). 
Der Fehler halbiert sich mit jedem Iterationsschritt, was nicht so schnell wie das Newtonverfahren ist, die Laufzeit des Programms aber dennoch in einem akzeptablen Rahmen hält.
\begin{figure}[tbp]
\centering
\includegraphics[width=0.55\textwidth]{./figures/bisektion.eps}
\caption{Bisektions-Verfahren}
\label{fig:bisektion}
\end{figure}

\subsubsection{Numerische Integration mit rekursivem Simpson-Verfahren}

Wir verwenden zur numerischen Integration eine rekursive Variante des Simpson-Verfahrens, bei der das Intervall, über dem integriert wird, mit jedem Rekursionsschritt in zwei Hälften zerlegt wird, auf die die normale Simpson-Methode angewendet wird (s. \cite{kuncir}). Ist die Differenz zwischen dem mit Simpson über dem ganzen Intervall berechneten Integralwert und der Summe der zwei Teilintervalle größer als eine vorgegebene Genauigkeit, wird die Funktion rekursiv aufgerufen, wodurch jedes der Teilintervalle erneut halbiert wird. Durch dieses Vorgehen fallen im Gegensatz zum gewöhnlichen Simpsonverfahren einige laufzeitbeeinträchtigende Funktionsaufrufe weg.

\subsubsection{Abbruchbedingungen}

Integrationsgrenzen
\begin{figure}[htbp]
\centering
\input{./figures/rho}
\caption{Integrand für T=300K}
\end{figure}

\begin{figure}[htbp]
\centering
\input{./figures/rho_sonne}
\caption{Integrand für T=5750K}

\input{./figures/temperatur}
\caption{Ergebnisse}
\end{figure}

\subsubsection{Genaugkeit}

\subsection{Physikalische Ergebnisse}
\label{ssec:physikalischeergebnisse}

\begin{thebibliography}{9}

\bibitem{kuncir}
 Kuncir, Guy F.,
 \emph{Algorithm 103: Simpson's Rule Integrator},
 Commun. ACM \textbf{5}(6) (1962)


\bibitem{abramowitzstegun}
Abramowitz, M. \& Stegun, I. A.
\emph{Handbook of Mathematical Functions},
Dover Books (1965)

\bibitem{healdmarion}
Heald, M. \& Marion, J.
\emph{Classical Electromagnetic Radiation},
Brooks Cole (1994)

\bibitem{kazimierczuk}
Kazimierczuk, M.
\emph{High-Frequency Magnetic Components},
Wiley (2009)

\bibitem{crchandbook}
David R. Lide (ed),
\emph{CRC Handbook of Chemistry and Physics},
84th Edition. CRC Press. Boca Raton, Florida, 2003;
Section 12, Properties of Solids; Electrical Resistivity of Pure Metals;
Section 4, The Elements: Magnetic Susceptibility

\end{thebibliography}

\end{document}
